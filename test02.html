<!-- ...existing code... -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Global Migration to Australia Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background-color: #f8f9fa; color: #333; line-height: 1.6; }
        header { background: linear-gradient(135deg,#2c3e50,#4a235a); color:#fff; padding:2rem 1rem; text-align:center; box-shadow:0 4px 12px rgba(0,0,0,.15); position:relative; overflow:hidden; }
        header h1 { font-size:2.5rem; margin-bottom:.5rem; }
        .subtitle { font-size:1.2rem; opacity:.9; font-weight:300; }
        .dashboard-container { max-width:1400px; margin:0 auto; padding:2rem 1rem; }
        .controls-container { display:flex; flex-wrap:wrap; gap:1rem; margin-bottom:2rem; background:#fff; padding:1.5rem; border-radius:10px; box-shadow:0 4px 6px rgba(0,0,0,.05); }
        .filter-group { display:flex; flex-direction:column; flex:1; min-width:150px; }
        .filter-group label { font-weight:600; margin-bottom:.5rem; color:#4a235a; font-size:.9rem; }
        .filter-group select { padding:.7rem; border:1px solid #ddd; border-radius:5px; background:#f8f9fa; font-size:.9rem; }
        .facts-container { display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr)); gap:1.5rem; margin-bottom:2rem; }
        .fact-card { background:#fff; border-radius:10px; padding:1.5rem; box-shadow:0 4px 6px rgba(0,0,0,.05); transition:transform .3s, box-shadow .3s; border-left:4px solid #4a235a; }
        .charts-container { display:grid; grid-template-columns:1fr; gap:2rem; }
        .chart-box { background:#fff; border-radius:10px; padding:1.5rem; box-shadow:0 4px 6px rgba(0,0,0,.05); }
        .chart-box h2 { color:#4a235a; margin-bottom:1.5rem; padding-bottom:.5rem; border-bottom:1px solid #eee; font-weight:600; display:flex; gap:.7rem; align-items:center; }
        .chart-container { width:100%; height:400px; }
        .reset-btn { background:#4a235a; color:#fff; border:none; padding:.7rem 1.5rem; border-radius:5px; cursor:pointer; font-weight:600; transition:background .3s; align-self:flex-end; margin-top:1.5rem; }
        .reset-btn:hover { background:#6c3483; }
        footer { text-align:center; padding:2rem 1rem; margin-top:2rem; background:#2c3e50; color:#ddd; font-size:.9rem; }
        @media (min-width:992px) { .charts-container { grid-template-columns:1fr 1fr; } }
        @media (max-width:768px) { header h1 { font-size:2rem } .subtitle { font-size:1rem } .controls-container { flex-direction:column } .fact-card { min-width:100% } }
    </style>
</head>
<body>
    <header>
        <h1><i class="fas fa-globe-asia"></i> Global Migration to Australia Dashboard</h1>
        <p class="subtitle">Interactive Analysis of Global Migration Patterns</p>
    </header>

    <div class="dashboard-container">
        <div class="facts-container">
            <div class="fact-card">
                <h3><i class="fas fa-chart-line"></i> Migration-Dependent Nation</h3>
                <p>Over 30% of Australia's population was born overseas — the highest proportion among OECD nations (2023). Migration has been the main driver of Australia's population growth for decades.</p>
            </div>
            <div class="fact-card">
                <h3><i class="fas fa-crown"></i> UK: Largest Source of Migrants</h3>
                <p>Historically, the UK has been the top origin country, with around 1 million UK-born residents currently living in Australia. This reflects deep cultural and historical ties.</p>
            </div>
            <div class="fact-card">
                <h3><i class="fas fa-rocket"></i> Asia: Fastest-Growing Source</h3>
                <p>Migration from China and India has surged in the last two decades. Each country now contributes over 600,000 migrants, driven by education, skilled migration, and family reunion programs.</p>
            </div>
            <div class="fact-card">
                <h3><i class="fas fa-network-wired"></i> Diversifying Migration Patterns</h3>
                <p>Beyond traditional sources, migration from Southeast Asia (Vietnam, Philippines, Malaysia) and Africa (South Africa) has steadily increased — showing how Australia's migration network has become globally diversified.</p>
            </div>
            <div class="fact-card">
                <h3><i class="fas fa-balance-scale"></i> Policy Shapes Migration Flows</h3>
                <p>Major policy reforms (like Australia's points-based skilled migration system) and global events (such as the COVID-19 pandemic) have visibly affected annual migration trends.</p>
            </div>
        </div>

        <div class="controls-container">
            <div class="filter-group">
                <label for="countryFilter"><i class="fas fa-flag"></i> Country</label>
                <select id="countryFilter"><option value="All">All Countries</option></select>
            </div>
            <div class="filter-group">
                <label for="ageFilter"><i class="fas fa-user"></i> Age Group</label>
                <select id="ageFilter"><option value="All">All Age Groups</option></select>
            </div>
            <div class="filter-group">
                <label for="genderFilter"><i class="fas fa-venus-mars"></i> Gender</label>
                <select id="genderFilter"><option value="All">All Genders</option></select>
            </div>
            <div class="filter-group">
                <label for="stateFilter"><i class="fas fa-map-marker-alt"></i> Australian State</label>
                <select id="stateFilter"><option value="All">All States</option></select>
            </div>
            <button class="reset-btn" id="resetFilters"><i class="fas fa-redo"></i> Reset Filters</button>
        </div>

        <div class="charts-container">
            <div class="chart-box">
                <h2><i class="fas fa-globe-americas"></i> World Migration Map</h2>
                <div id="worldMap" class="chart-container"></div>
            </div>
            <div class="chart-box">
                <h2><i class="fas fa-chart-bar"></i> Migration to Australian States</h2>
                <div id="stateChart" class="chart-container"></div>
            </div>
            <div class="chart-box">
                <h2><i class="fas fa-chart-pie"></i> Migration by Age & Gender</h2>
                <div id="demographicChart" class="chart-container"></div>
            </div>
            <div class="chart-box">
                <h2><i class="fas fa-exchange-alt"></i> Top Migration Sources</h2>
                <div id="countryChart" class="chart-container"></div>
            </div>
        </div>
    </div>

    <footer>
        <p>Data visualized using Vega-Lite | Source: Migration Dataset</p>
    </footer>

    <script>
        const migrationData = [
            { Country: "India", CountryCode: "IND", Latitude: 20.5937, Longitude: 78.9629, AgeGroup: "20-29", Gender: "Male", State: "Victoria", Population: 15000 },
            { Country: "India", CountryCode: "IND", Latitude: 20.5937, Longitude: 78.9629, AgeGroup: "20-29", Gender: "Female", State: "Victoria", Population: 12000 },
            { Country: "India", CountryCode: "IND", Latitude: 20.5937, Longitude: 78.9629, AgeGroup: "30-39", Gender: "Male", State: "New South Wales", Population: 11000 },
            { Country: "India", CountryCode: "IND", Latitude: 20.5937, Longitude: 78.9629, AgeGroup: "30-39", Gender: "Female", State: "New South Wales", Population: 9000 },
            { Country: "China", CountryCode: "CHN", Latitude: 35.8617, Longitude: 104.1954, AgeGroup: "20-29", Gender: "Male", State: "Victoria", Population: 13000 },
            { Country: "China", CountryCode: "CHN", Latitude: 35.8617, Longitude: 104.1954, AgeGroup: "20-29", Gender: "Female", State: "Victoria", Population: 11000 },
            { Country: "China", CountryCode: "CHN", Latitude: 35.8617, Longitude: 104.1954, AgeGroup: "30-39", Gender: "Male", State: "Queensland", Population: 8000 },
            { Country: "China", CountryCode: "CHN", Latitude: 35.8617, Longitude: 104.1954, AgeGroup: "30-39", Gender: "Female", State: "Queensland", Population: 7000 },
            { Country: "United Kingdom", CountryCode: "GBR", Latitude: 55.3781, Longitude: -3.4360, AgeGroup: "40-49", Gender: "Male", State: "Western Australia", Population: 6000 },
            { Country: "United Kingdom", CountryCode: "GBR", Latitude: 55.3781, Longitude: -3.4360, AgeGroup: "40-49", Gender: "Female", State: "Western Australia", Population: 5500 },
            { Country: "United Kingdom", CountryCode: "GBR", Latitude: 55.3781, Longitude: -3.4360, AgeGroup: "50-59", Gender: "Male", State: "South Australia", Population: 4000 },
            { Country: "United Kingdom", CountryCode: "GBR", Latitude: 55.3781, Longitude: -3.4360, AgeGroup: "50-59", Gender: "Female", State: "South Australia", Population: 3500 },
            { Country: "Philippines", CountryCode: "PHL", Latitude: 12.8797, Longitude: 121.7740, AgeGroup: "20-29", Gender: "Female", State: "New South Wales", Population: 9000 },
            { Country: "Philippines", CountryCode: "PHL", Latitude: 12.8797, Longitude: 121.7740, AgeGroup: "30-39", Gender: "Female", State: "Victoria", Population: 7000 },
            { Country: "Philippines", CountryCode: "PHL", Latitude: 12.8797, Longitude: 121.7740, AgeGroup: "30-39", Gender: "Male", State: "Queensland", Population: 5000 },
            { Country: "New Zealand", CountryCode: "NZL", Latitude: -40.9006, Longitude: 174.8860, AgeGroup: "20-29", Gender: "Male", State: "Victoria", Population: 6000 },
            { Country: "New Zealand", CountryCode: "NZL", Latitude: -40.9006, Longitude: 174.8860, AgeGroup: "20-29", Gender: "Female", State: "New South Wales", Population: 5500 },
            { Country: "New Zealand", CountryCode: "NZL", Latitude: -40.9006, Longitude: 174.8860, AgeGroup: "30-39", Gender: "Male", State: "Queensland", Population: 4500 },
            { Country: "United States", CountryCode: "USA", Latitude: 37.0902, Longitude: -95.7129, AgeGroup: "20-29", Gender: "Male", State: "New South Wales", Population: 4000 },
            { Country: "United States", CountryCode: "USA", Latitude: 37.0902, Longitude: -95.7129, AgeGroup: "20-29", Gender: "Female", State: "Victoria", Population: 3500 },
            { Country: "United States", CountryCode: "USA", Latitude: 37.0902, Longitude: -95.7129, AgeGroup: "30-39", Gender: "Male", State: "Queensland", Population: 3000 },
            { Country: "South Africa", CountryCode: "ZAF", Latitude: -30.5595, Longitude: 22.9375, AgeGroup: "30-39", Gender: "Male", State: "Western Australia", Population: 3500 },
            { Country: "South Africa", CountryCode: "ZAF", Latitude: -30.5595, Longitude: 22.9375, AgeGroup: "30-39", Gender: "Female", State: "Victoria", Population: 3000 },
            { Country: "Malaysia", CountryCode: "MYS", Latitude: 4.2105, Longitude: 101.9758, AgeGroup: "20-29", Gender: "Female", State: "Victoria", Population: 4000 },
            { Country: "Malaysia", CountryCode: "MYS", Latitude: 4.2105, Longitude: 101.9758, AgeGroup: "20-29", Gender: "Male", State: "New South Wales", Population: 3500 }
        ];

        document.addEventListener('DOMContentLoaded', () => {
            initializeFilters();
            renderCharts();
        });

        function initializeFilters() {
            const countries = [...new Set(migrationData.map(d => d.Country))];
            const ageGroups = [...new Set(migrationData.map(d => d.AgeGroup))];
            const genders = [...new Set(migrationData.map(d => d.Gender))];
            const states = [...new Set(migrationData.map(d => d.State))];

            const countryFilter = document.getElementById('countryFilter');
            countries.forEach(c => { const opt = document.createElement('option'); opt.value = c; opt.textContent = c; countryFilter.appendChild(opt); });

            const ageFilter = document.getElementById('ageFilter');
            ageGroups.forEach(a => { const opt = document.createElement('option'); opt.value = a; opt.textContent = a; ageFilter.appendChild(opt); });

            const genderFilter = document.getElementById('genderFilter');
            genders.forEach(g => { const opt = document.createElement('option'); opt.value = g; opt.textContent = g; genderFilter.appendChild(opt); });

            const stateFilter = document.getElementById('stateFilter');
            states.forEach(s => { const opt = document.createElement('option'); opt.value = s; opt.textContent = s; stateFilter.appendChild(opt); });

            document.getElementById('countryFilter').addEventListener('change', updateCharts);
            document.getElementById('ageFilter').addEventListener('change', updateCharts);
            document.getElementById('genderFilter').addEventListener('change', updateCharts);
            document.getElementById('stateFilter').addEventListener('change', updateCharts);
            document.getElementById('resetFilters').addEventListener('click', resetFilters);
        }

        function resetFilters() {
            document.getElementById('countryFilter').value = 'All';
            document.getElementById('ageFilter').value = 'All';
            document.getElementById('genderFilter').value = 'All';
            document.getElementById('stateFilter').value = 'All';
            updateCharts();
        }

        function getFilteredData() {
            const countryFilter = document.getElementById('countryFilter').value;
            const ageFilter = document.getElementById('ageFilter').value;
            const genderFilter = document.getElementById('genderFilter').value;
            const stateFilter = document.getElementById('stateFilter').value;

            return migrationData.filter(d =>
                (countryFilter === 'All' || d.Country === countryFilter) &&
                (ageFilter === 'All' || d.AgeGroup === ageFilter) &&
                (genderFilter === 'All' || d.Gender === genderFilter) &&
                (stateFilter === 'All' || d.State === stateFilter)
            );
        }

        function updateCharts() {
            const filtered = getFilteredData();
            renderCharts(filtered);
        }

        function renderCharts(data = migrationData) {
            const countryData = {};
            data.forEach(d => {
                if (!countryData[d.CountryCode]) {
                    countryData[d.CountryCode] = { Country: d.Country, CountryCode: d.CountryCode, Latitude: d.Latitude, Longitude: d.Longitude, Population: 0 };
                }
                countryData[d.CountryCode].Population += d.Population;
            });
            const mapData = Object.values(countryData);

            const mapSpec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "World map showing migration to Australia",
                width: "container",
                height: 350,
                layer: [
                    {
                        data: {
                            url: "https://cdn.jsdelivr.net/npm/vega-datasets@2/data/world-110m.json",
                            format: { type: "topojson", feature: "countries" }
                        },
                        mark: { type: "geoshape", fill: "#f2f2f2", stroke: "#000", strokeWidth: 0.6 },
                        projection: { type: "mercator" }
                    },
                    {
                        data: { values: mapData },
                        mark: { type: "circle", tooltip: true, stroke: "#000", strokeWidth: 0.9, opacity: 0.92 },
                        encoding: {
                            longitude: { field: "Longitude", type: "quantitative" },
                            latitude: { field: "Latitude", type: "quantitative" },
                            size: {
                                field: "Population",
                                type: "quantitative",
                                title: "Migrants (size)",
                                scale: { range: [120, 2800] },
                                legend: { title: "Migrants (size)", orient: "bottom", format: ".0f" }
                            },
                            color: {
                                field: "Population",
                                type: "quantitative",
                                title: "Migrants (colour)",
                                scale: { scheme: "viridis" },
                                legend: { title: "Migrants", orient: "right", format: ".0f" }
                            },
                            tooltip: [
                                { field: "Country", type: "nominal", title: "Country" },
                                { field: "Population", type: "quantitative", title: "Migrants", format: ".0f" }
                            ]
                        }
                    }
                ],
                config: { view: { stroke: "transparent" }, background: "transparent" }
            };

            const stateSpec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "Migration flow to Australian states",
                width: "container",
                height: 350,
                data: { values: data },
                mark: { type: "bar", cornerRadius: 4 },
                encoding: {
                    x: { field: "State", type: "nominal", title: "Australian State", axis: { labelAngle: 0 }, sort: "-y" },
                    y: { aggregate: "sum", field: "Population", type: "quantitative", title: "Number of Migrants", axis: { format: ".0f" } },
                    color: { field: "State", type: "nominal", title: "State", scale: { range: ["#4a235a","#6c3483","#8e44ad","#af7ac5","#d2b4de","#e8daef"] }, legend: { orient: "bottom", titleFontSize: 12, labelFontSize: 10 } },
                    tooltip: [ { field: "State", title: "State" }, { aggregate: "sum", field: "Population", title: "Migrants", format: ".0f" } ]
                },
                config: { view: { stroke: "transparent" }, axis: { grid: false } }
            };

            const demographicSpec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "Migration by age and gender",
                width: "container",
                height: 350,
                data: { values: data },
                mark: { type: "bar", cornerRadius: 4 },
                encoding: {
                    x: { field: "AgeGroup", type: "nominal", title: "Age Group", axis: { labelAngle: 0 } },
                    y: { aggregate: "sum", field: "Population", type: "quantitative", title: "Number of Migrants", axis: { format: ".0f" } },
                    color: { field: "Gender", type: "nominal", title: "Gender", scale: { range: ["#6c3483","#f39c9c"] } },
                    tooltip: [ { field: "AgeGroup", title: "Age Group" }, { field: "Gender", title: "Gender" }, { aggregate: "sum", field: "Population", title: "Migrants", format: ".0f" } ]
                },
                config: { view: { stroke: "transparent" }, axis: { grid: false } }
            };

            const countrySpec = {
                $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                description: "Top migration sources by country",
                width: "container",
                height: 350,
                data: { values: data },
                transform: [
                    { aggregate: [{ op: "sum", field: "Population", as: "TotalMigrants" }], groupby: ["Country"] },
                    { sort: [{ field: "TotalMigrants", order: "descending" }] },
                    { window: [{ op: "row_number", as: "rank" }] },
                    { filter: "datum.rank <= 10" }
                ],
                mark: { type: "bar", cornerRadius: 4 },
                encoding: {
                    x: { field: "TotalMigrants", type: "quantitative", title: "Number of Migrants", axis: { format: ".0f" } },
                    y: { field: "Country", type: "nominal", title: "Country", sort: "-x" },
                    color: { field: "Country", type: "nominal", title: "Country", scale: { scheme: "purples" }, legend: null },
                    tooltip: [ { field: "Country", title: "Country" }, { field: "TotalMigrants", title: "Migrants", format: ".0f" } ]
                },
                config: { view: { stroke: "transparent" }, axis: { grid: false } }
            };

            vegaEmbed('#worldMap', mapSpec, { actions: false }).catch(err => {
                console.error('World map embed failed:', err);
                const fallbackSpec = {
                    $schema: "https://vega.github.io/schema/vega-lite/v5.json",
                    description: "Fallback: migration by country",
                    width: "container",
                    height: 350,
                    data: { values: mapData },
                    mark: "bar",
                    encoding: {
                        x: { field: "Country", type: "nominal", title: "Country", axis: { labelAngle: 45 } },
                        y: { field: "Population", type: "quantitative", title: "Migrants to Australia", axis: { format: ".0f" } },
                        color: { field: "Country", type: "nominal", legend: null },
                        tooltip: [ { field: "Country", title: "Country" }, { field: "Population", title: "Migrants", format: ".0f" } ]
                    }
                };
                vegaEmbed('#worldMap', fallbackSpec, { actions: false });
            });

            vegaEmbed('#stateChart', stateSpec, { actions: false });
            vegaEmbed('#demographicChart', demographicSpec, { actions: false });
            vegaEmbed('#countryChart', countrySpec, { actions: false });
        }
    </script>
</body>
</html>
<!-- ...existing code... -->