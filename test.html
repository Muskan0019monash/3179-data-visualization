<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Migration Dashboard - Map & States</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary: #4a235a;
            --primary-light: #6c3483;
            --secondary: #1a5276;
            --accent: #d35400;
            --light-bg: #f8f9fa;
            --card-bg: #ffffff;
            --text: #333333;
            --text-light: #666666;
            --border: #e0e0e0;
            
            /* State colors */
            --nsw: #3498db;
            --vic: #e74c3c;
            --qld: #f39c12;
            --wa: #9b59b6;
            --sa: #2ecc71;
            --tas: #1abc9c;
            --nt: #e67e22;
            --act: #95a5a6;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 2rem 1rem;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="none"><path d="M0,0 L100,0 L100,100 Z" fill="rgba(255,255,255,0.05)"/></svg>');
            background-size: cover;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            font-weight: 300;
            max-width: 600px;
            margin: 0 auto;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 2rem;
        }

        @media (min-width: 992px) {
            .charts-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .chart-box {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .chart-box:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .chart-box h2 {
            color: var(--primary);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.7rem;
        }

        .chart-box h2 i {
            font-size: 1.3rem;
        }

        .chart-container {
            width: 100%;
            flex: 1;
            min-height: 400px;
        }

        .chart-description {
            margin-top: 1rem;
            padding: 1rem;
            background-color: var(--light-bg);
            border-radius: 8px;
            border-left: 4px solid var(--primary);
            font-size: 0.9rem;
            color: var(--text-light);
        }

        footer {
            text-align: center;
            padding: 2rem 1rem;
            margin-top: 2rem;
            background: var(--primary);
            color: #ddd;
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }
            
            .subtitle {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1><i class="fas fa-globe-asia"></i> Global Migration to Australia Dashboard</h1>
            <p class="subtitle">Interactive Analysis of Global Migration Patterns and Trends</p>
        </div>
    </header>

    <div class="dashboard-container">
        <div class="charts-container">
            <div class="chart-box">
                <div class="chart-header">
                    <h2><i class="fas fa-globe-americas"></i> Global Migration Flow</h2>
                </div>
                <div id="worldMap" class="chart-container"></div>
                <div class="chart-description">
                    <p><strong>Insight:</strong> This map visualizes the global distribution of migrants to Australia. The United Kingdom leads with over 1 million migrants, followed by China and India. The map highlights Australia's position as a "melting pot" of cultures from around the world.</p>
                </div>
            </div>
            <div class="chart-box">
                <div class="chart-header">
                    <h2><i class="fas fa-chart-bar"></i> State Settlement Patterns</h2>
                </div>
                <div id="stateChart" class="chart-container"></div>
                <div class="chart-description">
                    <p><strong>Insight:</strong> New South Wales and Victoria are the primary gateways for migrants, attracting over 60% of newcomers. These states offer the "golden ticket" with established migrant communities and diverse economic opportunities.</p>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>Data visualized using Vega-Lite | Source: Migration Dataset</p>
    </footer>

    <script>
        // Convert CSV data to JavaScript objects
        const migrationData = [
            { country: "United Kingdom", lon: -0.1276, lat: 51.5072, migrants: 1000000, year: 2023, region: "Europe", age_group: "Mixed", gender_ratio: 0.52, education_level: "High", settlement_state: "NSW" },
            { country: "China", lon: 116.4074, lat: 39.9042, migrants: 650000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.48, education_level: "High", settlement_state: "VIC" },
            { country: "India", lon: 77.2090, lat: 28.6139, migrants: 600000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.45, education_level: "Medium", settlement_state: "NSW" },
            { country: "New Zealand", lon: 174.7633, lat: -36.8485, migrants: 550000, year: 2023, region: "Oceania", age_group: "Mixed", gender_ratio: 0.51, education_level: "High", settlement_state: "QLD" },
            { country: "Vietnam", lon: 105.8544, lat: 21.0285, migrants: 300000, year: 2023, region: "Asia", age_group: "Middle", gender_ratio: 0.49, education_level: "Medium", settlement_state: "VIC" },
            { country: "Italy", lon: 12.4964, lat: 41.9028, migrants: 250000, year: 2023, region: "Europe", age_group: "Older", gender_ratio: 0.53, education_level: "Medium", settlement_state: "SA" },
            { country: "Philippines", lon: 121.7740, lat: 12.8797, migrants: 200000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.54, education_level: "Medium", settlement_state: "WA" },
            { country: "South Africa", lon: 28.0473, lat: -26.2041, migrants: 180000, year: 2023, region: "Africa", age_group: "Mixed", gender_ratio: 0.47, education_level: "High", settlement_state: "NSW" },
            { country: "Malaysia", lon: 101.6869, lat: 3.1390, migrants: 170000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.50, education_level: "High", settlement_state: "VIC" },
            { country: "Sri Lanka", lon: 80.7718, lat: 7.8731, migrants: 150000, year: 2023, region: "Asia", age_group: "Middle", gender_ratio: 0.46, education_level: "Medium", settlement_state: "NSW" },
            { country: "Germany", lon: 10.4515, lat: 51.1657, migrants: 140000, year: 2023, region: "Europe", age_group: "Mixed", gender_ratio: 0.49, education_level: "High", settlement_state: "VIC" },
            { country: "Lebanon", lon: 35.8623, lat: 33.8547, migrants: 130000, year: 2023, region: "Middle East", age_group: "Mixed", gender_ratio: 0.48, education_level: "Medium", settlement_state: "NSW" },
            { country: "Greece", lon: 21.8243, lat: 39.0742, migrants: 120000, year: 2023, region: "Europe", age_group: "Older", gender_ratio: 0.52, education_level: "Medium", settlement_state: "VIC" },
            { country: "Thailand", lon: 100.9925, lat: 15.8700, migrants: 110000, year: 2023, region: "Asia", age_group: "Mixed", gender_ratio: 0.55, education_level: "Medium", settlement_state: "QLD" },
            { country: "Indonesia", lon: 113.9213, lat: -0.7893, migrants: 100000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.51, education_level: "Medium", settlement_state: "WA" },
            { country: "South Korea", lon: 127.7669, lat: 35.9078, migrants: 95000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.47, education_level: "High", settlement_state: "NSW" },
            { country: "Japan", lon: 138.2529, lat: 36.2048, migrants: 90000, year: 2023, region: "Asia", age_group: "Mixed", gender_ratio: 0.49, education_level: "High", settlement_state: "VIC" },
            { country: "Nepal", lon: 85.3240, lat: 28.3949, migrants: 85000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.44, education_level: "Low", settlement_state: "QLD" },
            { country: "Bangladesh", lon: 90.3563, lat: 23.6850, migrants: 80000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.43, education_level: "Low", settlement_state: "NSW" },
            { country: "Pakistan", lon: 69.3451, lat: 30.3753, migrants: 75000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.42, education_level: "Medium", settlement_state: "VIC" },
            { country: "Iran", lon: 53.6880, lat: 32.4279, migrants: 70000, year: 2023, region: "Middle East", age_group: "Mixed", gender_ratio: 0.46, education_level: "High", settlement_state: "NSW" },
            { country: "Turkey", lon: 35.2433, lat: 38.9637, migrants: 65000, year: 2023, region: "Europe", age_group: "Mixed", gender_ratio: 0.48, education_level: "Medium", settlement_state: "VIC" },
            { country: "Afghanistan", lon: 67.7090, lat: 33.9391, migrants: 60000, year: 2023, region: "Asia", age_group: "Young", gender_ratio: 0.41, education_level: "Low", settlement_state: "NSW" },
            { country: "Myanmar", lon: 95.9560, lat: 21.9162, migrants: 55000, year: 2023, region: "Asia", age_group: "Mixed", gender_ratio: 0.52, education_level: "Low", settlement_state: "WA" },
            { country: "Brazil", lon: -51.9253, lat: -14.2350, migrants: 50000, year: 2023, region: "South America", age_group: "Young", gender_ratio: 0.51, education_level: "Medium", settlement_state: "QLD" }
        ];

        // State color mapping - consistent throughout
        const stateColors = {
            "NSW": "#3498db",  // Blue
            "VIC": "#e74c3c",  // Red
            "QLD": "#f39c12",  // Orange
            "WA": "#9b59b6",   // Purple
            "SA": "#2ecc71",   // Green
            "TAS": "#1abc9c",  // Teal
            "NT": "#e67e22",   // Dark Orange
            "ACT": "#95a5a6"   // Gray
        };

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            renderCharts();
        });

        function renderCharts() {
            // Chart 1: World Map with Points
            const mapSpec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "description": "World map showing migration to Australia",
                "width": "container",
                "height": 400,
                "layer": [
                    {
                        // Base world map with black borders
                        "data": {
                            "url": "https://cdn.jsdelivr.net/npm/vega-datasets@2/data/world-110m.json",
                            "format": {
                                "type": "topojson",
                                "feature": "countries"
                            }
                        },
                        "mark": {
                            "type": "geoshape",
                            "fill": "#f0f0f0",
                            "stroke": "#000",
                            "strokeWidth": 0.3
                        },
                        "projection": {
                            "type": "equirectangular"
                        }
                    },
                    {
                        // Migration data points
                        "data": {
                            "values": migrationData
                        },
                        "mark": {
                            "type": "circle",
                            "tooltip": true,
                            "stroke": "#000",
                            "strokeWidth": 1
                        },
                        "encoding": {
                            "longitude": {
                                "field": "lon",
                                "type": "quantitative"
                            },
                            "latitude": {
                                "field": "lat",
                                "type": "quantitative"
                            },
                            "size": {
                                "field": "migrants",
                                "type": "quantitative",
                                "title": "Migrants to Australia",
                                "scale": {
                                    "range": [50, 2000]
                                },
                                "legend": {
                                    "direction": "horizontal",
                                    "gradientLength": 120,
                                    "titleFontSize": 12,
                                    "labelFontSize": 10,
                                    "orient": "bottom"
                                }
                            },
                            "color": {
                                "field": "migrants",
                                "type": "quantitative",
                                "title": "Number of Migrants",
                                "scale": {
                                    "scheme": "viridis"
                                },
                                "legend": {
                                    "direction": "vertical",
                                    "gradientLength": 150,
                                    "titleFontSize": 12,
                                    "labelFontSize": 10,
                                    "orient": "right"
                                }
                            },
                            "tooltip": [
                                {"field": "country", "type": "nominal", "title": "Country"},
                                {"field": "migrants", "type": "quantitative", "title": "Migrants", "format": ","},
                                {"field": "region", "type": "nominal", "title": "Region"},
                                {"field": "education_level", "type": "nominal", "title": "Education Level"}
                            ]
                        }
                    }
                ],
                "config": {
                    "view": {"stroke": "transparent"},
                    "background": "transparent"
                }
            };

            // Chart 2: Migration to Australian States with consistent colors
            const stateSpec = {
                "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                "description": "Migration flow to Australian states",
                "width": "container",
                "height": 400,
                "data": {
                    "values": migrationData
                },
                "mark": {
                    "type": "bar",
                    "cornerRadius": 4
                },
                "encoding": {
                    "x": {
                        "field": "settlement_state",
                        "type": "nominal",
                        "title": "Australian State",
                        "axis": {"labelAngle": 0},
                        "sort": "-y"
                    },
                    "y": {
                        "aggregate": "sum",
                        "field": "migrants",
                        "type": "quantitative",
                        "title": "Number of Migrants"
                    },
                    "color": {
                        "field": "settlement_state",
                        "type": "nominal",
                        "title": "State",
                        "scale": {
                            "domain": Object.keys(stateColors),
                            "range": Object.values(stateColors)
                        },
                        "legend": {
                            "orient": "bottom",
                            "titleFontSize": 12,
                            "labelFontSize": 10
                        }
                    },
                    "tooltip": [
                        {"field": "settlement_state", "title": "State"},
                        {"aggregate": "sum", "field": "migrants", "title": "Migrants", "format": ","}
                    ]
                },
                "config": {
                    "view": {"stroke": "transparent"},
                    "axis": {"grid": false}
                }
            };

            // Embed charts
            vegaEmbed('#worldMap', mapSpec, {actions: false}).catch(error => {
                console.error("Error embedding world map:", error);
                // Fallback visualization
                const fallbackSpec = {
                    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
                    "description": "Migration by country (fallback)",
                    "width": "container",
                    "height": 400,
                    "data": {
                        "values": migrationData
                    },
                    "mark": "bar",
                    "encoding": {
                        "x": {
                            "field": "country",
                            "type": "nominal",
                            "title": "Country",
                            "axis": {"labelAngle": 45}
                        },
                        "y": {
                            "field": "migrants",
                            "type": "quantitative",
                            "title": "Migrants to Australia"
                        },
                        "color": {
                            "field": "country",
                            "type": "nominal",
                            "legend": null
                        },
                        "tooltip": [
                            {"field": "country", "title": "Country"},
                            {"field": "migrants", "title": "Migrants", "format": ","}
                        ]
                    }
                };
                vegaEmbed('#worldMap', fallbackSpec, {actions: false});
            });
            
            vegaEmbed('#stateChart', stateSpec, {actions: false});
        }
    </script>
</body>
</html>